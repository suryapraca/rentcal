<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulasi Biaya Pelayanan Sewa Kendaraan</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css">

<style>
#map { height: 500px; }
</style>
</head>

<body class="bg-dark">

<div class="container mt-4 text-light">
<h3 class="text-center">Simulasi Biaya Pelayanan Sewa Kendaraan</h3>

<div id="map" class="mb-3"></div>

<!-- BBM -->
<div class="mb-2">
<label>Jenis BBM</label>
<select id="fuelType" class="form-select">
<option value="pertalite">Pertalite - 10.000/L</option>
<option value="biosolar">Biosolar - 6.800/L</option>
</select>
</div>

<!-- Konsumsi BBM -->
<div class="mb-2">
<label>Konsumsi BBM</label>
<select id="fuelEfficiency" class="form-select">
<option value="5">1 : 5</option>
<option value="6">1 : 6</option>
<option value="7" selected>1 : 7</option>
<option value="8">1 : 8</option>
<option value="9">1 : 9</option>
<option value="10">1 : 10</option>
<option value="11">1 : 11</option>
<option value="12">1 : 12</option>
<option value="13">1 : 13</option>
<option value="14">1 : 14</option>
<option value="15">1 : 15</option>
<option value="16">1 : 16</option>
<option value="17">1 : 17</option>
</select>
</div>

<!-- Mobil -->
<div class="mb-2">
<label>Mobil</label>
<select id="carType" class="form-select">
<option value="innovaReborn24">Innova Reborn Diesel</option>
<option value="innovaZenix20">Innova Zenix</option>
<option value="hiacePremio28">Hiace Premio</option>
</select>
</div>

<!-- Tol -->
<div class="mb-2">
<label>Rute Tol</label>
<select id="tollRoute" class="form-select">
<option value="0">Tidak Pakai Tol</option>
<option value="10000">Surabaya - Gempol</option>
<option value="43500">Surabaya - Mojokerto</option>
<option value="57000">Surabaya - Malang</option>
<option value="883500">Surabaya - Jakarta</option>
</select>
</div>

<!-- Tanggal -->
<div class="row">
<div class="col">
<input type="date" id="startDate" class="form-control">
</div>
<div class="col">
<input type="date" id="endDate" class="form-control">
</div>
</div>

<div class="form-check mt-2">
<input class="form-check-input" type="checkbox" id="useDriver">
<label class="form-check-label">Gunakan Driver</label>
</div>

<div class="form-check">
<input class="form-check-input" type="checkbox" id="roundTrip">
<label class="form-check-label">Pulang Pergi (PP)</label>
</div>

<button id="calculateDistance" class="btn btn-primary w-100 mt-3">
Hitung Biaya
</button>

<div id="result" class="alert alert-info mt-3 d-none"></div>

</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

<script>
const map = L.map('map').setView([-7.2575,112.7521],13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

let points=[];
let route=null;

const fuelPrices={pertalite:10000,biosolar:6800};
const carPrices={innovaReborn24:400000,innovaZenix20:450000,hiacePremio28:800000};

map.on('click',e=>{
if(points.length>=2)return;
points.push(e.latlng);
L.marker(e.latlng).addTo(map);

if(points.length===2){
route=L.Routing.control({
waypoints:points,
createMarker:()=>null
}).addTo(map);

route.on('routesfound',e=>{
const distance=e.routes[0].summary.totalDistance/1000;
calculate(distance);
});
}
});

function calculate(distance){
const fuelType=fuelTypeEl.value;
const eff=parseFloat(fuelEfficiency.value);
let fuelCost=(distance/eff)*fuelPrices[fuelType];

let toll=parseInt(tollRoute.value);
if(roundTrip.checked){ fuelCost*=2; toll*=2; }

const sd=new Date(startDate.value);
const ed=new Date(endDate.value);
const days=Math.ceil((ed-sd)/86400000)+1;

const carCost=carPrices[carType.value]*days;

const total=fuelCost+toll+carCost;

result.innerHTML=`
<b>Jarak:</b> ${distance.toFixed(1)} km<br>
<b>BBM:</b> Rp ${fuelCost.toLocaleString()}<br>
<b>Tol:</b> Rp ${toll.toLocaleString()}<br>
<b>Sewa:</b> Rp ${carCost.toLocaleString()}<br>
<hr>
<b>Total:</b> Rp ${total.toLocaleString()}
`;
result.classList.remove('d-none');
}
</script>

</body>
</html>
